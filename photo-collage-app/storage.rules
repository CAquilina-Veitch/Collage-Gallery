rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    // Helper function to check if user is authenticated and whitelisted
    function isWhitelisted() {
      return request.auth != null && 
             request.auth.token.email in ['codethathat@gmail.com', 'marsha.o.y@gmail.com', 'commanderow@gmail.com'];
    }
    
    // Allow whitelisted users to read/write their album photos
    match /albums/{albumId}/{allPaths=**} {
      allow read: if isWhitelisted();
      allow write: if isWhitelisted();
    }
  }
}